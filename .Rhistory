library(dplyr)
library(readr)
library(stringr)
library(stringi)
library(ggplot2)
library(plotly)
library(lubridate)
options(scipen=999)
#Transform to SARS_tour_data.csv
#---------------------------------------------------------
lo<- function(x) {str_replace_all(x,"合計","地區")}
## tour Country
tour_country <- function(country) {
tour_country <- tour %>%
filter(grepl(country, Location))
}
tour <- read_csv("C:/Users/user/DS_project/liao/tour.csv", col_names = FALSE) %>%
rename("Year"=X1,"Location"=X2,"Count"=X3) %>%
mutate(year=as.Date(paste(Year+1911,"-01-01", sep=""))) %>%
mutate(Location=lo(Location)) #將"合計"統一為"地區"
non_region <- tour %>%
filter(!grepl("地區",Location))
other_region <- tour %>%
filter(Location=="其他地區")
tour_total <- bind_rows(non_region, other_region) %>%  #旅遊總人數
group_by(Year) %>%
summarise(Count=sum(Count,na.rm = TRUE)) %>%
mutate(Year=Year+1911)%>%
mutate(Location="總人數") %>%
select(Year,Location,Count)
tour_asia <- tour_continent %>%
group_by(Location, Year) %>%
summarise(Count=sum(Count,na.rm = TRUE)) %>%
mutate(Year=Year+1911)%>%
filter(Location=="亞洲地區")%>%
select(Year,Location,Count)
tour_asia_country <- tour_country("中國|香港|澳門") %>%
mutate(Year=Year+1911)%>%
select(Year,Location,Count)
x <- full_join(tour_asia_country,tour_asia)
asia_asia.country_total <- full_join(x,tour_total)
# write_csv(asia_asia.country_total,"./unemployment.disease/data/SARS_tour_data.csv")
#---------------------------------------------
#Transform depatarture from taiwan airport 2002, 2003
#-----------------------------------------------
rp <- function(x) {stri_replace_all_fixed(x,"%","")}
depart <- read_csv("./unemployment.disease/data/tai_depart_2003.csv")[,1:4]
colnames(depart) <- c("month","2003.d.count","2002.d.count","growth")
depart <- depart %>%
filter(month != "小計") %>%
mutate(growth=as.numeric(rp(growth))) %>%
mutate(month=1:12)
# write_csv(depart,"./unemployment.disease/data/depart.cleaned.csv")
View(tour_asia_country)
View(tour_total)
rm(list = ls())
# setwd("C:/Users/user/rlads_communicate/communicate.web.source")
library(dplyr)
library(readr)
library(stringr)
library(stringi)
library(ggplot2)
library(plotly)
library(lubridate)
options(scipen=999)
#Transform to SARS_tour_data.csv
#---------------------------------------------------------
lo<- function(x) {str_replace_all(x,"合計","地區")}
## tour Country
tour_country <- function(country) {
tour_country <- tour %>%
filter(grepl(country, Location))
}
tour <- read_csv("C:/Users/user/DS_project/liao/tour.csv", col_names = FALSE) %>%
rename("Year"=X1,"Location"=X2,"Count"=X3) %>%
mutate(year=as.Date(paste(Year+1911,"-01-01", sep=""))) %>%
mutate(Location=lo(Location)) #將"合計"統一為"地區"
non_region <- tour %>%
filter(!grepl("地區",Location))
other_region <- tour %>%
filter(Location=="其他地區")
tour_total <- bind_rows(non_region, other_region) %>%  #旅遊總人數
group_by(Year) %>%
summarise(Count=sum(Count,na.rm = TRUE)) %>%
mutate(Year=Year+1911)%>%
mutate(Location="總人數") %>%
select(Year,Location,Count)
tour_continent <- tour %>%
filter(grepl("地區",Location)) %>%
filter(!grepl("其他地區",Location))
tour_asia <- tour_continent %>%
group_by(Location, Year) %>%
summarise(Count=sum(Count,na.rm = TRUE)) %>%
mutate(Year=Year+1911)%>%
filter(Location=="亞洲地區")%>%
select(Year,Location,Count)
tour_asia_country <- tour_country("中國|香港|澳門") %>%
mutate(Year=Year+1911)%>%
select(Year,Location,Count)
x <- full_join(tour_asia_country,tour_asia)
asia_asia.country_total <- full_join(x,tour_total)
# write_csv(asia_asia.country_total,"./unemployment.disease/data/SARS_tour_data.csv")
#---------------------------------------------
#Transform depatarture from taiwan airport 2002, 2003
#-----------------------------------------------
rp <- function(x) {stri_replace_all_fixed(x,"%","")}
depart <- read_csv("./unemployment.disease/data/tai_depart_2003.csv")[,1:4]
colnames(depart) <- c("month","2003.d.count","2002.d.count","growth")
depart <- depart %>%
filter(month != "小計") %>%
mutate(growth=as.numeric(rp(growth))) %>%
mutate(month=1:12)
# write_csv(depart,"./unemployment.disease/data/depart.cleaned.csv")
View(asia_asia.country_total)
write_csv(asia_asia.country_total,"./unemployment.disease/data/SARS_tour_data.csv")
# setwd("C:/Users/user/rlads_communicate/communicate.web.source")
library(readr)
library(dplyr)
library(lubridate)
library(dygraphs)
library(RColorBrewer)
library(ggplot2)
library(plotly)
library(xts)
library(scales)
options(scipen=999)
tour_year <- read_csv("./unemployment.disease/data/SARS_tour_data.csv") %>% filter(Location!="中國大陸")
depart_2003 <- read_csv("./unemployment.disease/data/depart.cleaned.csv")
depart_2003 <- depart_2003[,-ncol(depart_2003)]
pl_tour_year=ggplot(tour_year,mapping = aes(x=Year, y=Count/10000))+
geom_line(mapping = aes(color=Location))+
scale_x_continuous(limits=c(1997,2009) ,breaks=seq(1995,2015,by=2))+
scale_y_continuous(breaks=seq(0, 1000, by=100))+
labs(Color="",y="萬人",main="")
# ggplotly(pl_tour_year)
pl_depart_2003 <- dygraph(depart_2003, main = "桃機出境人數",xlab="月份") %>%
dyOptions(axisLabelFontSize = 12, axisLineWidth = 0.8, drawGrid=F) %>%
dySeries("2003.d.count", axis = 'y', label = "2003", color = hue_pal()(2)[1]) %>%
dySeries("2002.d.count", axis = 'y', label = "2002", color=hue_pal()(2)[2]) %>%
dyAxis("y", label = "人數") %>%
dyHighlight(highlightSeriesOpts = list(strokeWidth = 3),highlightSeriesBackgroundAlpha=1) %>%
dyLegend(labelsSeparateLines=T)
# pl_depart_2003
rm(list = ls())
# setwd("C:/Users/user/rlads_communicate/communicate.web.source")
library(readr)
library(dplyr)
library(lubridate)
library(dygraphs)
library(RColorBrewer)
library(ggplot2)
library(plotly)
library(xts)
library(scales)
options(scipen=999)
tour_year <- read_csv("./unemployment.disease/data/SARS_tour_data.csv") %>% filter(Location!="中國大陸")
depart_2003 <- read_csv("./unemployment.disease/data/depart.cleaned.csv")
depart_2003 <- depart_2003[,-ncol(depart_2003)]
pl_tour_year=ggplot(tour_year,mapping = aes(x=Year, y=Count/10000))+
geom_line(mapping = aes(color=Location))+
scale_x_continuous(limits=c(1997,2009) ,breaks=seq(1995,2015,by=2))+
scale_y_continuous(breaks=seq(0, 1000, by=100))+
labs(Color="",y="萬人",main="")
# ggplotly(pl_tour_year)
pl_depart_2003 <- dygraph(depart_2003, main = "桃機出境人數",xlab="月份") %>%
dyOptions(axisLabelFontSize = 12, axisLineWidth = 0.8, drawGrid=F) %>%
dySeries("2003.d.count", axis = 'y', label = "2003", color = hue_pal()(2)[1]) %>%
dySeries("2002.d.count", axis = 'y', label = "2002", color=hue_pal()(2)[2]) %>%
dyAxis("y", label = "人數") %>%
dyHighlight(highlightSeriesOpts = list(strokeWidth = 3),highlightSeriesBackgroundAlpha=1) %>%
dyLegend(labelsSeparateLines=T)
# pl_depart_2003
ggplotly(pl_tour_year)
rm(list = ls())
# setwd("C:/Users/user/rlads_communicate/communicate.web.source")
library(readr)
library(dplyr)
library(lubridate)
library(dygraphs)
library(RColorBrewer)
library(ggplot2)
library(plotly)
library(xts)
library(scales)
options(scipen=999)
tour_year <- read_csv("./unemployment.disease/data/SARS_tour_data.csv") %>% filter(Location!="中國大陸")
depart_2003 <- read_csv("./unemployment.disease/data/depart.cleaned.csv")
depart_2003 <- depart_2003[,-ncol(depart_2003)]
pl_tour_year=ggplot(tour_year,mapping = aes(x=Year, y=Count/10000))+
geom_line(mapping = aes(color=Location))+
scale_x_continuous(limits=c(1998,2009) ,breaks=seq(1995,2015,by=2))+
scale_y_continuous(breaks=seq(0, 1000, by=100))+
labs(Color="",y="萬人",main="1998-2009 旅遊人數變化")
# ggplotly(pl_tour_year)
pl_depart_2003 <- dygraph(depart_2003, main = "桃機出境人數",xlab="月份") %>%
dyOptions(axisLabelFontSize = 12, axisLineWidth = 0.8, drawGrid=F) %>%
dySeries("2003.d.count", axis = 'y', label = "2003", color = hue_pal()(2)[1]) %>%
dySeries("2002.d.count", axis = 'y', label = "2002", color=hue_pal()(2)[2]) %>%
dyAxis("y", label = "人數") %>%
dyHighlight(highlightSeriesOpts = list(strokeWidth = 3),highlightSeriesBackgroundAlpha=1) %>%
dyLegend(labelsSeparateLines=T)
# pl_depart_2003
ggplotly(pl_tour_year)
?labs
rm(list = ls())
# setwd("C:/Users/user/rlads_communicate/communicate.web.source")
library(readr)
library(dplyr)
library(lubridate)
library(dygraphs)
library(RColorBrewer)
library(ggplot2)
library(plotly)
library(xts)
library(scales)
options(scipen=999)
tour_year <- read_csv("./unemployment.disease/data/SARS_tour_data.csv") %>% filter(Location!="中國大陸")
depart_2003 <- read_csv("./unemployment.disease/data/depart.cleaned.csv")
depart_2003 <- depart_2003[,-ncol(depart_2003)]
pl_tour_year <- ggplot(tour_year,mapping = aes(x=Year, y=Count/10000))+
geom_line(mapping = aes(color=Location))+
scale_x_continuous(limits=c(1998,2009) ,breaks=seq(1995,2015,by=2))+
scale_y_continuous(breaks=seq(0, 1000, by=100))+
labs(colour="",x="",y="萬人",title="1998-2009 旅遊人數變化")
# ggplotly(pl_tour_year)
pl_depart_2003 <- dygraph(depart_2003, main = "桃機出境人數",xlab="月份") %>%
dyOptions(axisLabelFontSize = 12, axisLineWidth = 0.8, drawGrid=F) %>%
dySeries("2003.d.count", axis = 'y', label = "2003", color = hue_pal()(2)[1]) %>%
dySeries("2002.d.count", axis = 'y', label = "2002", color=hue_pal()(2)[2]) %>%
dyAxis("y", label = "人數") %>%
dyHighlight(highlightSeriesOpts = list(strokeWidth = 3),highlightSeriesBackgroundAlpha=1) %>%
dyLegend(labelsSeparateLines=T)
# pl_depart_2003
ggplotly(pl_tour_year)
pl_depart_2003
Sys.setlocale(category = "LC_ALL", locale = "cht")
library(readr)
library(dplyr)
library(ggplot2)
library(plotly)
library(tidyr)
m2008 <- read_csv("./china/m2008.csv")%>%rename("Travelers"=`number of visitors`)
m2009 <- read_csv("./china/m2009.csv")%>%rename("Travelers"=`number of visitors`)
m2010 <- read_csv("./china/m2010.csv")%>%rename("Travelers"=`number of visitors`)
m2008_2010 <- read_csv("./china/m2008_2010.csv")%>%
rename("Travelers"=`number of visitors`)%>%
separate(Month,c("Year","Month"),sep="/") %>%
mutate(Month=ifelse(Month %in% 1:9 ,paste(Year,"/0",Month,sep = ""),paste(Year,"/",Month,sep = ""))) %>%
select(Month,Location,Travelers)
China08_17 <- read_csv("./china/China08_17.csv")%>%
rename("Travelers"=`number of visitors`)%>%
separate(Month,c("Year","Month"),sep="/") %>%
mutate(Month=ifelse(Month %in% 1:9 ,paste(Year,"/0",Month,sep = ""),paste(Year,"/",Month,sep = ""))) %>%
select(Month,Location,Travelers)
newm2012_2017 <- read_csv("./china/newm2012_2017.csv")%>%
rename("Travelers"=`number of visitors`)%>%
separate(Month,c("year","Month"),sep="/") %>%
mutate(Month=ifelse(Month %in% 1:9 ,paste(year,"/0",Month,sep = ""),paste(year,"/",Month,sep = ""))) %>%
select(Month,Location,Travelers)
## Plotting
pl_2008_ea <- ggplot(m2008,mapping = aes(x=Month, y=Travelers/10000))+
geom_line(mapping = aes(color=Location))+
scale_x_continuous(limits=c(1,12) ,breaks=1:12)+
scale_y_continuous(breaks=seq(0, 30, by=2))+
labs(title = "2008 台灣人前往東亞地區",x="月份",y="萬人\n \n",color="")
# ggplotly(pl_2008_ea)
pl_2009_ea <- ggplot(m2009,mapping = aes(x=Month, y=Travelers/10000))+
geom_line(mapping = aes(color=Location))+
scale_x_continuous(limits=c(1,12) ,breaks=1:12)+
scale_y_continuous(breaks=seq(0, 30, by=2))+
labs(title = "2009 台灣人前往東亞地區",x="月份",y="萬人\n \n",color="")
# ggplotly(pl_2009_ea)
pl_2010_ea <- ggplot(m2010,mapping = aes(x=Month, y=Travelers/10000))+
geom_line(mapping = aes(color=Location))+
scale_x_continuous(limits=c(1,12) ,breaks=1:12)+
scale_y_continuous(breaks=seq(0, 30, by=2))+
labs(title = "2010 台灣人前往東亞地區",x="月份",y="萬人\n \n",color="")
# ggplotly(pl_2010_ea)
mlabels=unique(m2008_2010$Month)
m2008_2010$Month = factor(m2008_2010$Month, labels=mlabels, ordered=T)
index <- seq.int(1, length(m2008_2010$Month), by=2)
pl_2008_10_ea <- ggplot(m2008_2010,mapping = aes(x=Month, y=Travelers/10000, group=Location))+
geom_line(mapping = aes(color=Location))+
scale_x_discrete(breaks=m2008_2010$Month[index]) +
scale_y_continuous(breaks=seq(0, 30, by=2))+
labs(title = "2008-2010 台灣人前往東亞地區(月)",x=" ",y="萬人\n \n",color="")+
theme(axis.text.x = element_text(angle = 90, hjust = 1))
# ggplotly(pl_2008_10_ea)
mlabels=unique(China08_17$Month)
China08_17$Month = factor(China08_17$Month, labels=mlabels, ordered=T)
index <- seq.int(1, length(China08_17$Month), by=3)
pl_2008_17_ch <- ggplot(China08_17,mapping = aes(x=Month, y=Travelers/10000, group=Location))+
geom_line(mapping = aes(color=Location))+
geom_smooth(method="lm",formula=y~poly(x, 3),color="skyblue")+
scale_x_discrete(breaks=China08_17$Month[index]) +
scale_y_continuous(breaks=seq(0, 45, by=3))+
labs(title = "2008-2017(Oct) 台灣人前往中國(月)",x=" ",y="萬人<br> <br>",color="")+
theme(axis.text.x = element_text(angle = 90, hjust = 1))
# ggplotly(pl_2008_17_ch)
mlabels=unique(newm2012_2017$Month)
newm2012_2017$Month = factor(newm2012_2017$Month, labels=mlabels, ordered=T)
index <- seq.int(1, length(newm2012_2017$Month), by=2)
pl_2012_17_all <- ggplot(newm2012_2017,mapping = aes(x=Month, y=Travelers/10000, group=Location))+
geom_line(mapping = aes(color=Location))+
scale_x_discrete(breaks=newm2012_2017$Month[index]) +
scale_y_continuous(breaks=seq(0, 45, by=3))+
labs(title = "2012-2017(Oct) 台灣人最常前往地區(月)",x=" ",y="萬人\n \n",color="")+
theme(axis.text.x = element_text(angle = 90, hjust = 1))
# ggplotly(pl_2012_17_all)
ggplotly(pl_2012_17_all)
ggplotly(pl_2008_17_ch)
rm(list = ls())
library(readr)
library(dplyr)
library(leaflet)
library(sp)
library(rgdal)
library(tmap)
library(tmaptools)
?dyRangeSelector()
?dyLegend
>leaflet()
?leaflet
# setwd("C:/Users/user/rlads_communicate/communicate.web.source")
library(readr)
library(dplyr)
library(lubridate)
library(dygraphs)
library(RColorBrewer)
library(ggplot2)
library(plotly)
library(xts)
library(scales)
options(scipen=999)
tour_year <- read_csv("./unemployment.disease/data/SARS_tour_data.csv") %>% filter(Location!="中國大陸")
depart_2003 <- read_csv("./unemployment.disease/data/depart.cleaned.csv")
depart_2003 <- depart_2003[,-ncol(depart_2003)]
pl_tour_year <- ggplot(tour_year,mapping = aes(x=Year, y=Count/10000))+
geom_line(mapping = aes(color=Location))+
scale_x_continuous(limits=c(1998,2009) ,breaks=seq(1995,2015,by=2))+
scale_y_continuous(breaks=seq(0, 1000, by=100))+
labs(colour="",x="",y="萬人",title="1998-2009 出國旅遊人數變化")
# ggplotly(pl_tour_year)
pl_depart_2003 <- dygraph(depart_2003, main = "2003/2002 桃機出境人數",xlab="月份") %>%
dyOptions(axisLabelFontSize = 12, axisLineWidth = 0.8, drawGrid=F) %>%
dySeries("2003.d.count", axis = 'y', label = "2003", color = hue_pal()(2)[1]) %>%
dySeries("2002.d.count", axis = 'y', label = "2002", color=hue_pal()(2)[2]) %>%
dyAxis("y", label = "人數") %>%
dyHighlight(highlightSeriesOpts = list(strokeWidth = 3),highlightSeriesBackgroundAlpha=1) %>%
dyLegend(labelsSeparateLines=T)
# pl_depart_2003
ggplotly(pl_tour_year)
pl_depart_2003
library(readr)
Age_County_Gender_SARS <- read_csv("unemployment.disease/data/Age_County_Gender_SARS.csv")
View(Age_County_Gender_SARS)
rm(list = ls())
library(readr)
tw_SARS_case <- read_csv("./unemployment.disease/data/Age_County_Gender_SARS.csv")
View(tw_SARS_case)
tw_SARS_case <- tw_SARS_case[,c(2,3,4,5,9)]
View(tw_SARS_case)
tw_SARS_case <- tw_SARS_case[,c(2,3,4,5,9)]
colnames(tw_SARS_case) <- c("year","month","city","district","cases")
tw_SARS_case <- tw_SARS_case[,c(2,3,4,5,9)]
colnames(tw_SARS_case) <- c("year","month","city","district","cases")
View(tw_SARS_case)
tw_SARS_case <- tw_SARS_case %>%
mutate(month=ifelse(month %in% 1:9 ,paste(year,"/0",month,sep = ""),paste(year,"/",month,sep = "")))
View(tw_SARS_case)
library(readr)
tw_SARS_case <- read_csv("./unemployment.disease/data/Age_County_Gender_SARS.csv")
tw_SARS_case <- tw_SARS_case[,c(2,3,4,5,9)]
colnames(tw_SARS_case) <- c("year","month","city","district","cases")
View(tw_SARS_case)
tw_SARS_summary <- tw_SARS_case %>%
group_by(month) %>%
summary(sum(cases))
tw_SARS_summary <- tw_SARS_case %>%
group_by(month) %>%
summary(cases = sum(cases))
tw_SARS_summary <- tw_SARS_case %>%
group_by(month) %>%
summary(cases = cases)
tw_SARS_summary <- tw_SARS_case
tw_SARS_summary <- tw_SARS_case %>%
group_by(month) %>%
summary(cases = cases)
tw_SARS_summary <- tw_SARS_case %>%
group_by(month) %>%
summary(cases = n(cases))
tw_SARS_summary
tw_SARS_summary <- tw_SARS_case %>%
group_by(month) %>%
summarize(cases = sum(cases))
View(tw_SARS_summary)
month <- c(1,7:11)
cases <- rep(0, length(month))
month <- c(1,7:11)
cases <- rep(0, length(month))
df <- as.data.frame(cbind(month, cases))
View(df)
tw_SARS_summary <- rbind(tw_SARS_summary,df)
View(tw_SARS_summary)
tw_SARS_summary <- rbind(tw_SARS_summary,df) %>%
arrange(month)
tw_SARS_summary <- tw_SARS_case %>%
group_by(month) %>%
summarize(cases = sum(cases))
View(tw_SARS_summary)
month <- c(1,7:11)
cases <- rep(0, length(month))
df <- as.data.frame(cbind(month, cases))
tw_SARS_summary <- rbind(tw_SARS_summary,df) %>%
arrange(month)
View(tw_SARS_summary)
rm(list = ls())
library(readr)
tw_SARS_case <- read_csv("./unemployment.disease/data/Age_County_Gender_SARS.csv")
tw_SARS_case <- tw_SARS_case[,c(2,3,4,5,9)]
colnames(tw_SARS_case) <- c("year","month","city","district","cases")
tw_SARS_summary <- tw_SARS_case %>%
group_by(month) %>%
summarize(cases = sum(cases))
month <- c(1,7:11)
cases <- rep(0, length(month))
df <- as.data.frame(cbind(month, cases))
tw_SARS_summary <- rbind(tw_SARS_summary,df) %>%
arrange(month)
# mutate(month=ifelse(month %in% 1:9 ,paste(year,"/0",month,sep = ""),paste(year,"/",month,sep = "")))
View(tw_SARS_summary)
write_csv(tw_SARS_summary,"./unemployment.disease/data/SARS_cases.csv")
rm(list = ls())
library(readr)
SARS_cases <- read_csv("unemployment.disease/data/SARS_cases.csv")
View(SARS_cases)
SARS_cases <- read_csv("./unemployment.disease/data/SARS_cases.csv")
View(SARS_cases)
# setwd("C:/Users/user/rlads_communicate/communicate.web.source")
library(readr)
library(dplyr)
library(lubridate)
library(dygraphs)
library(RColorBrewer)
library(ggplot2)
library(plotly)
library(xts)
library(scales)
options(scipen=999)
tour_year <- read_csv("./unemployment.disease/data/SARS_tour_data.csv") %>% filter(Location!="中國大陸")
depart_2003 <- read_csv("./unemployment.disease/data/depart.cleaned.csv")
depart_2003 <- depart_2003[,-ncol(depart_2003)]
View(depart_2003)
depart_2003 <- left_join(depart_2003,SARS_cases,by="month")
View(depart_2003)
# ggplotly(pl_tour_year)
pl_depart_2003 <- dygraph(depart_2003, main = "2003/2002 桃機出境人數",xlab="月份") %>%
dyOptions(axisLabelFontSize = 12, axisLineWidth = 0.8, drawGrid=F) %>%
dySeries("2003.d.count", axis = 'y', label = "2003", color = hue_pal()(3)[1]) %>%
dySeries("2002.d.count", axis = 'y', label = "2002", color=hue_pal()(3)[3]) %>%
dySeries("cases", axis = 'y2', label = "SARS in Taiwan(2003)", color=hue_pal()(3)[2]) %>%
dyAxis("y", label = "出境人數") %>%
dyAxis("y2", label = "SARS案例",independentTicks=T) %>%
dyHighlight(highlightSeriesOpts = list(strokeWidth = 3),highlightSeriesBackgroundAlpha=1) %>%
dyLegend(labelsSeparateLines=T)
# pl_depart_2003
pl_depart_2003
?dyAxis
pl_depart_2003 <- dygraph(depart_2003, main = "2003/2002 桃機出境人數",xlab="月份") %>%
dyOptions(axisLabelFontSize = 12, axisLineWidth = 0.8, drawGrid=F) %>%
dySeries("2003.d.count", axis = 'y', label = "2003", color = hue_pal()(3)[1]) %>%
dySeries("2002.d.count", axis = 'y', label = "2002", color=hue_pal()(3)[3]) %>%
dySeries("cases", axis = 'y2', label = "SARS in Taiwan(2003)", color=hue_pal()(3)[2]) %>%
dyAxis("y", label = "出境人數") %>%
dyAxis("y2", label = "SARS案例",independentTicks=T,axisLineColor =hue_pal()(3)[3], axisLabelColor = hue_pal()(3)[3]) %>%
dyHighlight(highlightSeriesOpts = list(strokeWidth = 3),highlightSeriesBackgroundAlpha=1) %>%
dyLegend(labelsSeparateLines=T)
# pl_depart_2003
pl_depart_2003
# setwd("C:/Users/user/rlads_communicate/communicate.web.source")
library(readr)
library(dplyr)
library(lubridate)
library(dygraphs)
library(RColorBrewer)
library(ggplot2)
library(plotly)
library(xts)
library(scales)
options(scipen=999)
tour_year <- read_csv("./unemployment.disease/data/SARS_tour_data.csv") %>% filter(Location!="中國大陸")
depart_2003 <- read_csv("./unemployment.disease/data/depart.cleaned.csv")
depart_2003 <- depart_2003[,-ncol(depart_2003)]
SARS_cases <- read_csv("./unemployment.disease/data/SARS_cases.csv")
depart_2003 <- left_join(depart_2003,SARS_cases,by="month")
pl_tour_year <- ggplot(tour_year,mapping = aes(x=Year, y=Count/10000))+
geom_line(mapping = aes(color=Location))+
scale_x_continuous(limits=c(1998,2009) ,breaks=seq(1995,2015,by=2))+
scale_y_continuous(breaks=seq(0, 1000, by=100))+
labs(colour="",x="",y="萬人",title="1998-2009 出國旅遊人數變化")
# ggplotly(pl_tour_year)
pl_depart_2003 <- dygraph(depart_2003, main = "2003/2002 桃機出境人數",xlab="月份") %>%
dyOptions(axisLabelFontSize = 12, axisLineWidth = 0.8, drawGrid=F) %>%
dySeries("2003.d.count", axis = 'y', label = "2003", color = hue_pal()(3)[1]) %>%
dySeries("2002.d.count", axis = 'y', label = "2002", color=hue_pal()(3)[3]) %>%
dySeries("cases", axis = 'y2', label = "SARS in Taiwan(2003)", color=hue_pal()(3)[2]) %>%
dyAxis("y", label = "出境人數") %>%
dyAxis("y2", label = "SARS案例",independentTicks=T,axisLineColor =hue_pal()(3)[2], axisLabelColor = hue_pal()(3)[2]) %>%
dyHighlight(highlightSeriesOpts = list(strokeWidth = 3),highlightSeriesBackgroundAlpha=1) %>%
dyLegend(labelsSeparateLines=T)
# pl_depart_2003
pl_depart_2003
